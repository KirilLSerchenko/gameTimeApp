{"version":3,"sources":["../../../src/lib/components/form/Form.tsx"],"names":["Form","props","e","preventDefault","onSubmit","subscribe","bind","unSubscribe","updateCallback","disableComponents","enableComponents","state","contextState","isFormValid","components","extraComponents","Object","keys","forEach","key","component","componentApi","disableComponent","enableComponent","touch","unTouch","className","mergeContext","children","getIsFormValid","componentId","componentState","setState","previousState","assign","initialValid","validation","isValid","previousComponent","React","PureComponent","noValidate","showExpandAll"],"mappings":"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","sourcesContent":["ï»¿// Libs\r\nimport * as React from 'react';\r\n\r\n// Misc\r\nimport { FormContextState, FormComponentContextState, FormContextProvider, ComponentsDict } from './FormContext';\r\n\r\nexport interface FormProps {\r\n  className?: string;\r\n  noValidate?: boolean;\r\n  onSubmit?: () => void;\r\n  extraComponents?: ComponentsDict;\r\n}\r\n\r\nexport interface FormState {\r\n  contextState: FormContextState;\r\n}\r\n\r\nexport class Form extends React.PureComponent<FormProps, FormState> {\r\n\r\n  public static defaultProps = {\r\n    noValidate: false,\r\n    showExpandAll: true\r\n  };\r\n\r\n  constructor(props: FormProps) {\r\n    super(props);\r\n    this.subscribe = this.subscribe.bind(this);\r\n    this.unSubscribe = this.unSubscribe.bind(this);\r\n    this.updateCallback = this.updateCallback.bind(this);\r\n    this.disableComponents = this.disableComponents.bind(this);\r\n    this.enableComponents = this.enableComponents.bind(this);\r\n    this.state = {\r\n      contextState: {\r\n        subscribe: this.subscribe,\r\n        unSubscribe: this.unSubscribe,\r\n        isFormValid: true,\r\n        updateCallback: this.updateCallback,\r\n        disableComponents: this.disableComponents,\r\n        enableComponents: this.enableComponents,\r\n        components: {}\r\n      },\r\n    };\r\n  }\r\n\r\n  public disableComponents() {\r\n    const components = { ...this.state.contextState.components, ...this.props.extraComponents };\r\n    Object.keys(components).forEach(key => {\r\n      const component = components[key];\r\n      component && component.componentApi && component.componentApi.disableComponent && component.componentApi.disableComponent();\r\n    });\r\n  }\r\n\r\n  public enableComponents() {\r\n    const components = { ...this.state.contextState.components, ...this.props.extraComponents };\r\n    Object.keys(components).forEach(key => {\r\n      const component = components[key];\r\n      component && component.componentApi && component.componentApi.enableComponent && component.componentApi.enableComponent();\r\n    });\r\n  }\r\n\r\n  public touchAll() {\r\n    const components = { ...this.state.contextState.components, ...this.props.extraComponents };\r\n    Object.keys(components).forEach(key => {\r\n      const component = components[key];\r\n      component && component.componentApi && component.componentApi.touch && component.componentApi.touch();\r\n    });\r\n  }\r\n\r\n  public unTouchAll() {\r\n    const components = { ...this.state.contextState.components, ...this.props.extraComponents };\r\n    Object.keys(components).forEach(key => {\r\n      const component = components[key];\r\n      component && component.componentApi && component.componentApi.unTouch && component.componentApi.unTouch();\r\n    });\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <form\r\n        noValidate={true}\r\n        role=\"form\"\r\n        className={`input__form validation-form ${(this.props.className ? this.props.className : '')}`}\r\n        onSubmit={this.onSubmit}\r\n      >\r\n        <FormContextProvider value={this.mergeContext()}>\r\n          {this.props.children}\r\n        </FormContextProvider>\r\n      </form>\r\n    );\r\n  }\r\n\r\n  private mergeContext(): FormContextState {\r\n    if (!this.props.extraComponents) {\r\n      return this.state.contextState;\r\n    }\r\n    const isFormValid = this.state.contextState.isFormValid && this.getIsFormValid(this.props.extraComponents);\r\n    return {\r\n      ...this.state.contextState,\r\n      components: {\r\n        ...this.state.contextState.components,\r\n        ...this.props.extraComponents\r\n      },\r\n      isFormValid\r\n    };\r\n  }\r\n\r\n  private onSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    this.props.onSubmit && this.props.onSubmit();\r\n  }\r\n\r\n  private subscribe(componentId: string, componentState: FormComponentContextState) {\r\n    if (componentId) {\r\n      this.setState(previousState => {\r\n        let components = Object.assign({}, previousState.contextState.components);\r\n        if (componentState) {\r\n          components[componentId] = componentState;\r\n        }\r\n        let isFormValid = this.getIsFormValid(components);\r\n        return {\r\n          contextState: {\r\n            ...previousState.contextState,\r\n            components,\r\n            isFormValid\r\n          },\r\n        };\r\n      });\r\n    }\r\n  }\r\n\r\n  private unSubscribe(componentId: string) {\r\n    if (componentId) {\r\n      this.setState(previousState => {\r\n        let components = Object.assign({}, previousState.contextState.components);\r\n        delete components[componentId];\r\n        let isFormValid = this.getIsFormValid(components);\r\n        return {\r\n          contextState: {\r\n            ...previousState.contextState,\r\n            components,\r\n            isFormValid\r\n          },\r\n        };\r\n      });\r\n    }\r\n  }\r\n\r\n  private getIsFormValid(components: ComponentsDict = this.state.contextState.components, initialValid: boolean = true): boolean {\r\n    let isFormValid = initialValid;\r\n    Object.keys(components).forEach(key => {\r\n      const component = components[key];\r\n      if (component && component.validation && !component.validation.isValid) {\r\n        isFormValid = false;\r\n      }\r\n    });\r\n    return isFormValid;\r\n  }\r\n\r\n  private updateCallback(componentId: string, componentState: FormComponentContextState) {\r\n    this.setState(previousState => {\r\n      let components = Object.assign({}, previousState.contextState.components);\r\n      const previousComponent = components[componentId];\r\n      if (componentState && previousComponent) {\r\n        components[componentId] = {\r\n          ...previousComponent,\r\n          ...componentState,\r\n          validation: {\r\n            ...previousComponent.validation,\r\n            ...componentState.validation\r\n          },\r\n        };\r\n\r\n      }\r\n      let isFormValid = this.getIsFormValid(components);\r\n      return {\r\n        contextState: {\r\n          ...this.state.contextState,\r\n          components,\r\n          isFormValid\r\n        },\r\n      };\r\n    });\r\n  }\r\n}\r\n\r\nexport default Form;"],"file":"Form.js"}